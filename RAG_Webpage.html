plaintext

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Systems from Scratch - Interactive Tutorial</title>
    
    <!-- Distinctive Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=IBM+Plex+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* Sophisticated Color Palette */
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary: #d97706;
            --accent: #059669;
            --accent-light: #10b981;
            
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-dark: #0f172a;
            
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            
            /* Glass effects */
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.18);
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            
            /* Borders */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 28px;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%);
            overflow-x: hidden;
        }
        
        /* Hero Section - Refined & Sophisticated */
        .hero {
            position: relative;
            padding: 120px 20px 80px;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #3b82f6 100%);
            color: white;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(217, 119, 6, 0.15) 0%, transparent 50%);
            animation: pulse 10s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .hero-content {
            max-width: 1100px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        .hero-badge {
            display: inline-block;
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            margin-bottom: 25px;
            animation: fadeInDown 0.8s ease;
        }
        
        .hero h1 {
            font-family: 'DM Serif Display', serif;
            font-size: 4.5rem;
            font-weight: 400;
            margin-bottom: 20px;
            letter-spacing: -0.02em;
            line-height: 1.1;
            animation: fadeInUp 0.8s ease 0.2s backwards;
            background: linear-gradient(135deg, #ffffff 0%, #cbd5e1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero .subtitle {
            font-size: 1.5rem;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 40px;
            line-height: 1.6;
            animation: fadeInUp 0.8s ease 0.4s backwards;
        }
        
        .hero-meta {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-bottom: 50px;
            animation: fadeInUp 0.8s ease 0.6s backwards;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            font-weight: 400;
            opacity: 0.85;
        }
        
        .meta-item i {
            font-size: 1.2rem;
            opacity: 0.7;
        }
        
        .cta-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            animation: fadeInUp 0.8s ease 0.8s backwards;
        }
        
        .btn {
            padding: 16px 36px;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 1.05rem;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: white;
            color: var(--primary);
            box-shadow: var(--shadow-xl);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-2xl);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        /* Floating Navigation */
        nav {
            position: sticky;
            top: 20px;
            z-index: 100;
            margin: -60px 20px 0;
            animation: slideDown 0.8s ease 1s backwards;
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 18px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
        }
        
        .nav-logo {
            font-family: 'DM Serif Display', serif;
            font-size: 1.5rem;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 12px;
            font-style: italic;
        }
        
        .nav-logo i {
            font-size: 1.6rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-links {
            display: flex;
            gap: 8px;
            list-style: none;
        }
        
        .nav-links a {
            padding: 10px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            border-radius: var(--radius-md);
            transition: var(--transition);
            position: relative;
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 6px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: var(--primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .nav-links a:hover {
            color: var(--primary);
        }
        
        .nav-links a:hover::after,
        .nav-links a.active::after {
            transform: scaleX(1);
        }
        
        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 60px auto;
            padding: 0 20px 40px;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 50px;
            align-items: start;
        }
        
        /* Sidebar TOC - Glassmorphism */
        .toc {
            position: sticky;
            top: 120px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: 30px;
            box-shadow: var(--shadow-lg);
        }
        
        .toc-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }
        
        .toc-header i {
            font-size: 1.4rem;
            color: var(--primary);
        }
        
        .toc-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: 0.02em;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc ul li {
            margin-bottom: 4px;
        }
        
        .toc ul li a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            border-radius: var(--radius-sm);
            transition: var(--transition);
            border-left: 3px solid transparent;
        }
        
        .toc ul li a i {
            font-size: 0.75rem;
            opacity: 0;
            transition: var(--transition);
        }
        
        .toc ul li a:hover,
        .toc ul li a.active {
            color: var(--primary);
            background: rgba(30, 58, 138, 0.05);
            border-left-color: var(--primary);
        }
        
        .toc ul li a:hover i,
        .toc ul li a.active i {
            opacity: 1;
        }
        
        .toc ul ul {
            margin-left: 20px;
            margin-top: 4px;
            border-left: 2px solid var(--border-light);
            padding-left: 10px;
        }
        
        .toc ul ul li a {
            font-size: 0.85rem;
            padding: 8px 12px;
        }
        
        /* Progress Indicator */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 101;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--accent-light));
            width: 0%;
            transition: width 0.2s ease;
        }
        
        /* Main Content */
        .content {
            background: white;
            border-radius: var(--radius-xl);
            padding: 60px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
        }
        
        .section {
            margin-bottom: 80px;
            scroll-margin-top: 120px;
        }
        
        .section:last-child {
            margin-bottom: 0;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--primary), transparent) 1;
        }
        
        .section-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            box-shadow: var(--shadow);
        }
        
        .section h2 {
            font-family: 'DM Serif Display', serif;
            font-size: 2.8rem;
            font-weight: 400;
            color: var(--text-primary);
            margin: 0;
            letter-spacing: -0.01em;
        }
        
        .section h3 {
            font-family: 'DM Serif Display', serif;
            font-size: 2rem;
            font-weight: 400;
            color: var(--text-primary);
            margin: 50px 0 25px;
            position: relative;
            padding-left: 25px;
        }
        
        .section h3::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 6px;
            height: 60%;
            background: linear-gradient(180deg, var(--secondary), var(--accent));
            border-radius: 3px;
        }
        
        .section h4 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 35px 0 18px;
        }
        
        .section p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 1.08rem;
            line-height: 1.8;
        }
        
        .section ul, .section ol {
            margin: 20px 0 20px 30px;
            color: var(--text-secondary);
        }
        
        .section li {
            margin-bottom: 12px;
            padding-left: 8px;
            line-height: 1.7;
        }
        
        .section li strong {
            color: var(--text-primary);
        }
        
        /* Info Boxes - Enhanced */
        .info-box {
            padding: 25px 30px;
            border-radius: var(--radius-lg);
            margin: 30px 0;
            display: flex;
            gap: 20px;
            align-items: start;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }
        
        .info-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
        }
        
        .info-box:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow);
        }
        
        .info-box i {
            font-size: 1.8rem;
            margin-top: 2px;
        }
        
        .info-box .content {
            flex: 1;
        }
        
        .info-box.note {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border: 1px solid #bfdbfe;
        }
        
        .info-box.note::before {
            background: linear-gradient(180deg, #3b82f6, #2563eb);
        }
        
        .info-box.note i {
            color: #2563eb;
        }
        
        .info-box.tip {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px solid #bbf7d0;
        }
        
        .info-box.tip::before {
            background: linear-gradient(180deg, #10b981, #059669);
        }
        
        .info-box.tip i {
            color: #059669;
        }
        
        .info-box.warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border: 1px solid #fde68a;
        }
        
        .info-box.warning::before {
            background: linear-gradient(180deg, #f59e0b, #d97706);
        }
        
        .info-box.warning i {
            color: #d97706;
        }
        
        .info-box.important {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fecaca;
        }
        
        .info-box.important::before {
            background: linear-gradient(180deg, #ef4444, #dc2626);
        }
        
        .info-box.important i {
            color: #dc2626;
        }
        
        /* Code Blocks - Sophisticated */
        .code-block {
            margin: 30px 0;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(15, 23, 42, 0.1);
            transition: var(--transition);
        }
        
        .code-block:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-2px);
        }
        
        .code-header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #cbd5e1;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'JetBrains Mono', monospace;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .code-header .language {
            color: #94a3b8;
            font-weight: 500;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .code-header .language::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent-light);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--accent-light);
        }
        
        .copy-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'IBM Plex Sans', sans-serif;
        }
        
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(1.05);
        }
        
        .code-block pre {
            margin: 0;
            padding: 25px;
            background: #0f172a;
            overflow-x: auto;
        }
        
        .code-block code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.92rem;
            line-height: 1.7;
        }
        
        /* Inline code */
        code {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: 4px 10px;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            color: var(--primary);
            border: 1px solid var(--border);
            font-weight: 500;
        }
        
        /* Tables - Elegant */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 30px 0;
            box-shadow: var(--shadow);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border);
        }
        
        thead {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }
        
        th {
            padding: 18px 24px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: 0.02em;
        }
        
        td {
            padding: 18px 24px;
            border-bottom: 1px solid var(--border-light);
            color: var(--text-secondary);
            background: white;
        }
        
        tbody tr {
            transition: var(--transition);
        }
        
        tbody tr:hover {
            background: var(--bg-tertiary);
        }
        
        tbody tr:last-child td {
            border-bottom: none;
        }
        
        /* Exercise Cards - Ultra Interactive */
        .exercise {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-xl);
            margin: 35px 0;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition-slow);
            position: relative;
        }
        
        .exercise::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            opacity: 0;
            transition: var(--transition);
        }
        
        .exercise:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-4px);
            border-color: var(--primary-light);
        }
        
        .exercise:hover::before {
            opacity: 1;
        }
        
        .exercise-header {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 25px 30px;
            border-bottom: 2px solid var(--border);
            cursor: pointer;
            user-select: none;
            transition: var(--transition);
        }
        
        .exercise-header:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }
        
        .exercise-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .exercise-title {
            display: flex;
            align-items: center;
            gap: 18px;
        }
        
        .exercise-number {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.4rem;
            box-shadow: var(--shadow);
            position: relative;
        }
        
        .exercise-number::after {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            opacity: 0.3;
            filter: blur(8px);
            z-index: -1;
        }
        
        .exercise-title h4 {
            margin: 0;
            font-size: 1.35rem;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .exercise-meta {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .badge {
            padding: 7px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            box-shadow: var(--shadow-sm);
        }
        
        .badge.beginner {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            color: #1e40af;
        }
        
        .badge.intermediate {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            color: #92400e;
        }
        
        .badge.advanced {
            background: linear-gradient(135deg, #fce7f3, #fbcfe8);
            color: #9f1239;
        }
        
        .time-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .toggle-icon {
            font-size: 1.3rem;
            color: var(--text-muted);
            transition: var(--transition);
        }
        
        .exercise-header:hover .toggle-icon {
            color: var(--primary);
        }
        
        .exercise-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .exercise-content {
            padding: 35px 30px;
            display: none;
            animation: expandDown 0.4s ease;
        }
        
        .exercise-content.active {
            display: block;
        }
        
        @keyframes expandDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .exercise-section {
            margin-bottom: 30px;
        }
        
        .exercise-section:last-child {
            margin-bottom: 0;
        }
        
        .exercise-section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .exercise-section-header i {
            font-size: 1.2rem;
            color: var(--primary);
        }
        
        .exercise-section-header h5 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            margin: 0;
        }
        
        /* Hints System */
        .hints-container {
            margin-top: 20px;
        }
        
        .hint-btn {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #fbbf24;
            color: #92400e;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .hint-btn:hover {
            background: linear-gradient(135deg, #fde68a, #fcd34d);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .hint {
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            border: 2px solid #fde68a;
            border-radius: var(--radius-md);
            display: none;
            animation: expandDown 0.3s ease;
        }
        
        .hint.active {
            display: block;
        }
        
        .hint-label {
            font-weight: 700;
            color: #92400e;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Solution Toggle - Enhanced */
        .solution-toggle {
            margin-top: 25px;
            padding: 16px 24px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            border: 2px dashed var(--border);
            border-radius: var(--radius-lg);
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            color: var(--primary);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1.05rem;
        }
        
        .solution-toggle:hover {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-style: solid;
            border-color: var(--primary);
            transform: scale(1.02);
            box-shadow: var(--shadow);
        }
        
        .solution {
            margin-top: 20px;
            padding: 30px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 2px solid #86efac;
            border-radius: var(--radius-lg);
            display: none;
            position: relative;
        }
        
        .solution::before {
            content: '✓';
            position: absolute;
            top: 15px;
            right: 15px;
            width: 35px;
            height: 35px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: var(--shadow);
        }
        
        .solution.active {
            display: block;
            animation: expandDown 0.4s ease;
        }
        
        .solution h5 {
            color: #166534;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        /* Progress Tracker for Exercises */
        .exercise-progress {
            margin-top: 25px;
            padding: 20px;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }
        
        .progress-track {
            height: 10px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
            border-radius: 10px;
            transition: width 0.6s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }
        
        .image-card {
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: var(--transition);
            background: white;
        }
        
        .image-card:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-5px);
        }
        
        .image-card img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }
        
        .image-placeholder {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 15px;
            color: var(--text-muted);
        }
        
        .image-placeholder i {
            font-size: 3rem;
            opacity: 0.3;
        }
        
        .image-caption {
            padding: 18px 20px;
            background: white;
        }
        
        .image-caption h5 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .image-caption p {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin: 0;
            line-height: 1.5;
        }
        
        /* Diagrams - Enhanced */
        .diagram {
            background: white;
            padding: 35px;
            border-radius: var(--radius-lg);
            border: 2px solid var(--border);
            margin: 35px 0;
            overflow-x: auto;
            box-shadow: var(--shadow);
            position: relative;
        }
        
        .diagram::before {
            content: 'DIAGRAM';
            position: absolute;
            top: 12px;
            right: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--text-muted);
            letter-spacing: 0.1em;
            opacity: 0.5;
        }
        
        .diagram pre {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.88rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin: 0;
        }
        
        /* Interactive Code Playground */
        .code-playground {
            margin: 30px 0;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }
        
        .playground-header {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 15px 25px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .playground-tabs {
            display: flex;
            gap: 10px;
        }
        
        .playground-tab {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .playground-tab.active {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .run-btn {
            background: var(--accent);
            color: white;
            padding: 8px 20px;
            border-radius: 6px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }
        
        .run-btn:hover {
            background: var(--accent-light);
            transform: scale(1.05);
        }
        
        .playground-editor {
            background: #0f172a;
            padding: 20px;
            min-height: 200px;
        }
        
        .playground-output {
            background: white;
            padding: 20px;
            border-top: 1px solid var(--border);
            min-height: 100px;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        
        /* Footer */
        footer {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #cbd5e1;
            padding: 80px 20px 40px;
            margin-top: 100px;
            position: relative;
        }
        
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 50px;
        }
        
        .footer-section h3 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section li {
            margin-bottom: 12px;
        }
        
        .footer-section a {
            color: #94a3b8;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .footer-section a:hover {
            color: white;
            padding-left: 5px;
        }
        
        .footer-bottom {
            max-width: 1400px;
            margin: 50px auto 0;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: #64748b;
        }
        
        /* Scroll to top - Floating */
        .scroll-top {
            position: fixed;
            bottom: 35px;
            right: 35px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
            z-index: 99;
        }
        
        .scroll-top::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            opacity: 0.3;
            filter: blur(12px);
            z-index: -1;
        }
        
        .scroll-top:hover {
            transform: translateY(-8px);
            box-shadow: 0 30px 40px -10px rgb(0 0 0 / 0.3);
        }
        
        .scroll-top.active {
            display: flex;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Responsive */
        @media (max-width: 1100px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .toc {
                position: static;
                margin-bottom: 30px;
            }
            
            .hero h1 {
                font-size: 3rem;
            }
        }
        
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2rem;
            }
            
            .hero .subtitle {
                font-size: 1.2rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .section h2 {
                font-size: 2rem;
            }
            
            .content {
                padding: 35px 25px;
            }
            
            .exercise-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .image-gallery {
                grid-template-columns: 1fr;
            }
        }
        
        /* Print */
        @media print {
            .hero, nav, .toc, footer, .scroll-top, .copy-btn, .hint-btn, .solution-toggle {
                display: none !important;
            }
            
            .container {
                grid-template-columns: 1fr;
                max-width: 100%;
            }
            
            .content {
                box-shadow: none;
                border: none;
                padding: 20px;
            }
            
            .section {
                page-break-inside: avoid;
            }
            
            .exercise-content {
                display: block !important;
            }
            
            .solution {
                display: block !important;
            }
        }
    </style>
</head>
<body>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Hero Section -->
    <div class="hero">
        <div class="hero-content">
            <div class="hero-badge">
                <i class="fas fa-graduation-cap"></i>
                INFO 7390 • Advanced Data Science
            </div>
            
            <h1>Building RAG Systems<br>from Scratch</h1>
            <p class="subtitle">
                A comprehensive, hands-on tutorial teaching you to build<br>
                intelligent question-answering systems using retrieval and generation
            </p>
            
            <div class="hero-meta">
                <div class="meta-item">
                    <i class="fas fa-user-circle"></i>
                    <span>Manish Kumar</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-university"></i>
                    <span>Northeastern University</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span>December 2025</span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span>~2 hour tutorial</span>
                </div>
            </div>
            
            
<div class="cta-buttons">
                <a href="#introduction" class="btn btn-primary">
                    <i class="fas fa-rocket"></i>
                    Start Learning
                </a>
                <a href="#exercises" class="btn btn-secondary">
                    <i class="fas fa-dumbbell"></i>
                    Practice Exercises
                </a>
                <a href="https://github.com/ManishKondoju/RAG_from_Sratch" class="btn btn-secondary" target="_blank">
                    <i class="fab fa-github"></i>
                    View Code
                </a>
                <a href="#quiz" class="btn btn-secondary">
                    <i class="fas fa-question-circle"></i>
                    Take Quiz
                </a>
            </div>

        </div>
    </div>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="#" class="nav-logo">
                <i class="fas fa-brain"></i>
                <span>RAG Mastery</span>
            </a>
            <ul class="nav-links">
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#theory">Theory</a></li>
                <li><a href="#implementation">Build</a></li>
                <li><a href="#exercises">Practice</a></li>
                <li><a href="#resources">Resources</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        
        <!-- Sidebar TOC -->
        <aside class="toc">
            <div class="toc-header">
                <i class="fas fa-list-ul"></i>
                <h3>Contents</h3>
            </div>
            <ul>
                <li><a href="#introduction"><i class="fas fa-arrow-right"></i> Introduction</a></li>
                <li><a href="#prerequisites"><i class="fas fa-arrow-right"></i> Prerequisites</a></li>
                <li><a href="#theory"><i class="fas fa-arrow-right"></i> Theory</a>
                    <ul>
                        <li><a href="#what-is-rag">What is RAG?</a></li>
                        <li><a href="#why-rag">Why RAG?</a></li>
                        <li><a href="#architecture">Architecture</a></li>
                        <li><a href="#components">Components</a></li>
                    </ul>
                </li>
                <li><a href="#implementation"><i class="fas fa-arrow-right"></i> Implementation</a>
                    <ul>
                        <li><a href="#setup">Setup</a></li>
                        <li><a href="#chunking">Chunking</a></li>
                        <li><a href="#embeddings">Embeddings</a></li>
                        <li><a href="#vector-store">Vector Store</a></li>
                        <li><a href="#retrieval">Retrieval</a></li>
                        <li><a href="#generation">Generation</a></li>
                    </ul>
                </li>
                <li><a href="#prompt-engineering"><i class="fas fa-arrow-right"></i> Prompts</a></li>
                <li><a href="#diagrams"><i class="fas fa-arrow-right"></i> Diagrams</a></li>
                <li><a href="#exercises"><i class="fas fa-arrow-right"></i> Exercises</a></li>
                <li><a href="#resources"><i class="fas fa-arrow-right"></i> Resources</a></li>
            </ul>
            
            <!-- Exercise Progress Tracker -->
            <div class="exercise-progress" style="margin-top: 25px;">
                <div class="progress-label">
                    <span>Your Progress</span>
                    <span id="progressText">0/10</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="exerciseProgress" style="width: 0%"></div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">

            <!-- Introduction Section -->
            <section id="introduction" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <h2>Introduction</h2>
                </div>
                
                <p>Welcome to the most comprehensive tutorial on <strong>Retrieval-Augmented Generation (RAG)</strong> systems! This hands-on guide will teach you everything from theoretical foundations to production deployment.</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">10+</div>
                        <div class="stat-label">Sections</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">50+</div>
                        <div class="stat-label">Code Examples</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">10</div>
                        <div class="stat-label">Exercises</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">3hrs</div>
                        <div class="stat-label">Learning Time</div>
                    </div>
                </div>
                
                <div class="info-box note">
                    <i class="fas fa-bullseye"></i>
                    <div class="content">
                        <strong>What You'll Build:</strong> A complete RAG system that answers questions by retrieving relevant documents from a knowledge base and generating natural, accurate responses using a language model - no APIs required!
                    </div>
                </div>
                
                <h3>🎯 Learning Objectives</h3>
                <p>By completing this tutorial, you will be able to:</p>
                <ul>
                    <li><strong>Understand</strong> the theoretical foundations of RAG and when to use it</li>
                    <li><strong>Implement</strong> each component: chunking, embeddings, retrieval, and generation</li>
                    <li><strong>Design</strong> effective prompts that maximize RAG quality</li>
                    <li><strong>Evaluate</strong> system performance using appropriate metrics</li>
                    <li><strong>Deploy</strong> production-ready RAG solutions</li>
                    <li><strong>Optimize</strong> for speed, accuracy, and cost</li>
                </ul>
                
                <h3>💡 Why RAG Matters</h3>
                <p>Imagine building a customer support chatbot for a tech company with thousands of products and policies. Traditional approaches fall short:</p>
                
                <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, #fee2e2); border-radius: var(--radius-lg); border: 2px solid #fecaca;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">❌</div>
                        <h4 style="margin: 0 0 10px; color: #991b1b;">Fine-Tuning</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: #7f1d1d;">Expensive retraining needed for every update. Slow and costly.</p>
                    </div>
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, #fee2e2); border-radius: var(--radius-lg); border: 2px solid #fecaca;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">❌</div>
                        <h4 style="margin: 0 0 10px; color: #991b1b;">Prompt Engineering</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: #7f1d1d;">Hits token limits with large knowledge bases. Not scalable.</p>
                    </div>
                    <div style="padding: 25px; background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-radius: var(--radius-lg); border: 2px solid #bbf7d0;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">✅</div>
                        <h4 style="margin: 0 0 10px; color: #166534;">RAG</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: #14532d;">Combines retrieval + generation. Scalable, accurate, and cost-effective!</p>
                    </div>
                </div>
            </section>

            <!-- Prerequisites -->
            <section id="prerequisites" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <h2>Prerequisites</h2>
                </div>
                
                <p>To maximize your learning, you should have:</p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Skill</th>
                            <th>Level</th>
                            <th>Why It Matters</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Python Programming</strong></td>
                            <td>Intermediate</td>
                            <td>Implementing RAG components and classes</td>
                        </tr>
                        <tr>
                            <td><strong>Machine Learning Basics</strong></td>
                            <td>Beginner</td>
                            <td>Understanding embeddings and models</td>
                        </tr>
                        <tr>
                            <td><strong>NLP Concepts</strong></td>
                            <td>Beginner</td>
                            <td>Context for language model applications</td>
                        </tr>
                        <tr>
                            <td><strong>NumPy/Pandas</strong></td>
                            <td>Basic</td>
                            <td>Data manipulation and analysis</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="info-box tip">
                    <i class="fas fa-check-circle"></i>
                    <div class="content">
                        <strong>New to these topics?</strong> Don't worry! This tutorial explains concepts clearly as we go, with working code examples you can learn from. The best way to learn is by doing!
                    </div>
                </div>
            </section>

            <!-- Theory Section -->
            <section id="theory" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <h2>Theoretical Foundations</h2>
                </div>
                
                <p>Before writing code, let's build a solid theoretical foundation. Understanding <em>why</em> RAG works helps you build better systems and debug issues effectively.</p>
                
                <!-- What is RAG -->
                <h3 id="what-is-rag">3.1 What is Retrieval-Augmented Generation?</h3>
                
                <p><strong>Retrieval-Augmented Generation (RAG)</strong> is a technique that enhances large language model responses by retrieving relevant information from an external knowledge base before generating an answer.</p>
                
                <div class="diagram">
                    <pre>
┌──────────────────────────────────────────────────────────────────────────┐
│                         RAG SYSTEM PIPELINE                              │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────┐      ┌──────────────┐      ┌─────────────────┐       │
│  │    User     │      │  Retrieval   │      │   Generation    │       │
│  │    Query    │─────▶│   System     │─────▶│     (LLM)       │─────▶ │
│  └─────────────┘      └──────────────┘      └─────────────────┘       │
│   "What is ML?"              │                   │                      │
│                              │                   │                      │
│                              ▼                   ▼                      │
│                    ┌──────────────────┐   ┌─────────────┐             │
│                    │  Vector Database │   │  Grounded   │             │
│                    │  (Millions of    │   │  Response   │             │
│                    │   Documents)     │   │             │             │
│                    └──────────────────┘   └─────────────┘             │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
                    </pre>
                </div>
                
                <div class="info-box note">
                    <i class="fas fa-key"></i>
                    <div class="content">
                        <strong>Key Insight:</strong> RAG augments an LLM's parametric memory (training data) with non-parametric memory (external documents), providing accuracy, recency, transparency, and cost-effectiveness without expensive retraining.
                    </div>
                </div>
                
                <!-- Why RAG -->
                <h3 id="why-rag">3.2 Why RAG? The Problems It Solves</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0;">
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, white); border-left: 4px solid #ef4444; border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 10px; color: #991b1b; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-calendar-times"></i> Problem 1: Knowledge Cutoff
                        </h4>
                        <p style="margin: 0 0 10px; font-size: 0.95rem; color: var(--text-secondary);">LLMs don't know about recent events, company data, or private information.</p>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--accent); font-weight: 600;">
                            <i class="fas fa-arrow-right"></i> RAG retrieves current documents at query time
                        </p>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, white); border-left: 4px solid #ef4444; border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 10px; color: #991b1b; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-exclamation-triangle"></i> Problem 2: Hallucination
                        </h4>
                        <p style="margin: 0 0 10px; font-size: 0.95rem; color: var(--text-secondary);">LLMs generate plausible but incorrect information.</p>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--accent); font-weight: 600;">
                            <i class="fas fa-arrow-right"></i> RAG grounds responses in real documents
                        </p>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, white); border-left: 4px solid #ef4444; border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 10px; color: #991b1b; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-compress"></i> Problem 3: Context Limits
                        </h4>
                        <p style="margin: 0 0 10px; font-size: 0.95rem; color: var(--text-secondary);">Can't fit entire knowledge bases in context windows.</p>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--accent); font-weight: 600;">
                            <i class="fas fa-arrow-right"></i> RAG retrieves only relevant pieces
                        </p>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef2f2, white); border-left: 4px solid #ef4444; border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 10px; color: #991b1b; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-dollar-sign"></i> Problem 4: High Costs
                        </h4>
                        <p style="margin: 0 0 10px; font-size: 0.95rem; color: var(--text-secondary);">Fine-tuning for updates is expensive and slow.</p>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--accent); font-weight: 600;">
                            <i class="fas fa-arrow-right"></i> RAG just updates the knowledge base
                        </p>
                    </div>
                </div>
                
                <!-- Architecture -->
                <h3 id="architecture">3.3 RAG Architecture</h3>
                
                <p>A production RAG system operates in two distinct phases:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin: 30px 0;">
                    <div style="padding: 30px; background: linear-gradient(135deg, #eff6ff, #dbeafe); border-radius: var(--radius-lg); border: 2px solid #93c5fd;">
                        <h4 style="margin: 0 0 15px; color: #1e40af;">
                            <i class="fas fa-database"></i> Phase 1: Indexing (Offline)
                        </h4>
                        <div class="diagram" style="margin: 15px 0; padding: 20px; background: white;">
                            <pre style="font-size: 0.8rem; margin: 0;">
Documents
   ↓
Chunking
   ↓
Embedding
   ↓
Vector Store</pre>
                        </div>
                        <p style="font-size: 0.9rem; margin: 0; color: #1e40af;">
                            <strong>One-time setup:</strong> Prepare your knowledge base
                        </p>
                    </div>
                    
                    <div style="padding: 30px; background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-radius: var(--radius-lg); border: 2px solid #86efac;">
                        <h4 style="margin: 0 0 15px; color: #166534;">
                            <i class="fas fa-bolt"></i> Phase 2: Query (Online)
                        </h4>
                        <div class="diagram" style="margin: 15px 0; padding: 20px; background: white;">
                            <pre style="font-size: 0.8rem; margin: 0;">
Query
   ↓
Embed
   ↓
Search
   ↓
Context + LLM
   ↓
Response</pre>
                        </div>
                        <p style="font-size: 0.9rem; margin: 0; color: #166534;">
                            <strong>Real-time:</strong> Answer user questions instantly
                        </p>
                    </div>
                </div>
                
                <!-- Components -->
                <h3 id="components">3.4 Core Components</h3>
                
                <h4>Component 1: Text Chunking</h4>
                <p><strong>Purpose:</strong> Break documents into digestible pieces for embedding and retrieval.</p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Strategy</th>
                            <th>Description</th>
                            <th>Best For</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Fixed-size</strong></td>
                            <td>Split every N tokens</td>
                            <td>Quick prototypes</td>
                        </tr>
                        <tr>
                            <td><strong>Sentence-based</strong></td>
                            <td>Split on sentence boundaries</td>
                            <td>General use ✅</td>
                        </tr>
                        <tr>
                            <td><strong>Semantic</strong></td>
                            <td>Split when topic changes</td>
                            <td>Advanced systems</td>
                        </tr>
                        <tr>
                            <td><strong>Recursive</strong></td>
                            <td>Paragraph → Sentence → Token</td>
                            <td>Production ✅</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Component 2: Embeddings</h4>
                <p><strong>Purpose:</strong> Convert text into numerical vectors that capture semantic meaning.</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">Embedding Concept</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python"># Semantic similarity through embeddings
"machine learning"        → [0.12, -0.43, 0.78, ..., 0.23]
"artificial intelligence" → [0.15, -0.41, 0.74, ..., 0.21]  # Similar vector!
"cooking recipes"         → [-0.52, 0.31, -0.19, ..., -0.44] # Different vector!

# Cosine similarity
similarity(ML, AI) = 0.92      # High - semantically related
similarity(ML, cooking) = 0.15 # Low - unrelated topics</code></pre>
                </div>
                
                <h4>Component 3: Vector Store</h4>
                <p><strong>Purpose:</strong> Efficiently store and search millions of vectors.</p>
                
                <div class="info-box important">
                    <i class="fas fa-bolt"></i>
                    <div class="content">
                        <strong>Performance:</strong> Vector stores use approximate nearest neighbor algorithms (HNSW, IVF) to search billions of vectors in milliseconds - crucial for real-time applications!
                    </div>
                </div>
                
                <h4>Component 4: Prompt Engineering</h4>
                <p>The prompt bridges retrieved documents and the LLM - it's where the magic happens!</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">Production Prompt Template</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">prompt = f"""You are a helpful AI assistant. Answer using ONLY the documents below.

**Rules:**
1. Use only provided context
2. Cite document numbers (e.g., "According to Document 1...")
3. If info missing: "I don't have information about [topic]"
4. Write 2-3 clear sentences

**Documents:**
{retrieved_documents}

**Question:** {user_query}

**Answer:**"""</code></pre>
                </div>
            </section>

            <!-- Visual Diagrams Section -->
            
            <section id="quiz" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <h2>RAG Concept Check (Mini Quiz)</h2>
                </div>

                <p>Use this quick quiz to test your understanding of Retrieval-Augmented Generation. 
                   Try to answer each question before expanding the answer section.</p>

                <div class="two-column-grid">
                    <article class="concept-card">
                        <h3>1. What problem does RAG primarily solve?</h3>
                        <ul>
                            <li>A) Making models faster to train</li>
                            <li>B) Letting LLMs access up-to-date or domain-specific knowledge</li>
                            <li>C) Compressing large models into smaller ones</li>
                            <li>D) Generating images from text</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> B. RAG allows an LLM to pull in relevant, external context at query time so it is not limited to what was seen during pretraining.</p>
                        </details>
                    </article>

                    <article class="concept-card">
                        <h3>2. In the RAG pipeline, what is the role of the <em>embedding model</em>?</h3>
                        <ul>
                            <li>A) Generate the final natural-language answer</li>
                            <li>B) Store documents on disk</li>
                            <li>C) Convert text (documents and queries) into vectors in a shared space</li>
                            <li>D) Rank answers by user preference</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> C. The embedding model encodes both documents and queries into vectors so that similarity search can find relevant context.</p>
                        </details>
                    </article>

                    <article class="concept-card">
                        <h3>3. Why do we use a vector store instead of a traditional SQL database index for retrieval?</h3>
                        <ul>
                            <li>A) Vector stores are cheaper than SQL databases</li>
                            <li>B) Vector stores support semantic similarity search over embeddings</li>
                            <li>C) SQL cannot store text at all</li>
                            <li>D) Vector stores automatically fine-tune the model</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> B. Vector stores are optimized for nearest-neighbor search in high-dimensional embedding space, which enables semantic (meaning-based) retrieval.</p>
                        </details>
                    </article>

                    <article class="concept-card">
                        <h3>4. What does the LLM see at the final generation step in a RAG system?</h3>
                        <ul>
                            <li>A) Only the user query</li>
                            <li>B) Only the retrieved documents</li>
                            <li>C) The query plus retrieved documents, formatted into a prompt</li>
                            <li>D) The entire document corpus</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> C. The orchestration layer constructs a prompt that combines the user query and the most relevant retrieved chunks, which the LLM then uses to generate an answer.</p>
                        </details>
                    </article>

                    <article class="concept-card">
                        <h3>5. Which of the following is a common failure mode of RAG?</h3>
                        <ul>
                            <li>A) Over-reliance on exact keyword matches</li>
                            <li>B) Hallucinating answers when retrieval returns poor or no results</li>
                            <li>C) Too much dependence on fine-tuning</li>
                            <li>D) Inability to handle long documents</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> B. If the retriever surfaces irrelevant or low-quality chunks, the LLM may still answer confidently, leading to hallucinations grounded in the wrong context.</p>
                        </details>
                    </article>

                    <article class="concept-card">
                        <h3>6. How can you improve RAG quality without changing the base LLM?</h3>
                        <ul>
                            <li>A) Use better chunking and document cleaning</li>
                            <li>B) Tune retrieval hyperparameters (k, similarity metric)</li>
                            <li>C) Improve prompt templates and instructions</li>
                            <li>D) All of the above</li>
                        </ul>
                        <details class="quiz-answer">
                            <summary>Show Answer</summary>
                            <p><strong>Correct:</strong> D. Most RAG improvements come from data quality, retrieval configuration, and prompt engineering rather than changing the base model.</p>
                        </details>
                    </article>
                </div>
            </section>


            <!-- Implementation Section -->
            <section id="implementation" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <h2>Implementation Guide</h2>
                </div>
                
                <p>Now let's build each component step by step. We'll use Python with open-source libraries - no APIs required!</p>
                
                <!-- Setup -->
                <h3 id="setup">5.1 Setup & Dependencies</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">bash - Installation</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-bash"># Install core libraries
pip install sentence-transformers  # Embeddings
pip install faiss-cpu              # Vector store
pip install transformers torch     # LLM
pip install nltk pandas numpy      # Utilities</code></pre>
                </div>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">python - Imports</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">import numpy as np
import pandas as pd
from typing import List, Dict, Optional
import logging

from sentence_transformers import SentenceTransformer
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
import faiss
import nltk

# Setup
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)
nltk.download('punkt', quiet=True)
nltk.download('punkt_tab', quiet=True)

print("✅ All libraries ready!")</code></pre>
                </div>
                
                <!-- Chunking Implementation -->
                <h3 id="chunking">5.2 Document Chunking</h3>
                
                <p>Implement intelligent chunking with sentence boundaries and overlap:</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">python - DocumentChunker Class</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">class DocumentChunker:
    """Intelligent chunking with overlap and metadata."""
    
    def __init__(self, chunk_size: int = 200, overlap: int = 50):
        self.chunk_size = chunk_size
        self.overlap = overlap
    
    def chunk_by_sentences(self, text: str) -> List[str]:
        """Split at sentence boundaries with overlap."""
        sentences = nltk.sent_tokenize(text)
        chunks, current_chunk, current_length = [], [], 0
        
        for sentence in sentences:
            sent_len = len(sentence.split())
            
            if current_length + sent_len > self.chunk_size and current_chunk:
                chunks.append(' '.join(current_chunk))
                
                # Add overlap
                overlap_sents = []
                overlap_len = 0
                for s in reversed(current_chunk):
                    if overlap_len + len(s.split()) <= self.overlap:
                        overlap_sents.insert(0, s)
                        overlap_len += len(s.split())
                    else:
                        break
                
                current_chunk = overlap_sents
                current_length = overlap_len
            
            current_chunk.append(sentence)
            current_length += sent_len
        
        if current_chunk:
            chunks.append(' '.join(current_chunk))
        
        return chunks</code></pre>
                </div>
                
                <div class="info-box tip">
                    <i class="fas fa-lightbulb"></i>
                    <div class="content">
                        <strong>Why sentence boundaries?</strong> Chunking mid-sentence destroys semantic meaning. Sentence-based chunking ensures each chunk is coherent and self-contained.
                    </div>
                </div>
                
                <!-- Continue with other sections... -->
                <h3 id="embeddings">5.3 Creating Embeddings</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">python - EmbeddingGenerator Class</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">class EmbeddingGenerator:
    """Generate embeddings using sentence-transformers."""
    
    def __init__(self, model_name: str = 'all-MiniLM-L6-v2'):
        self.model = SentenceTransformer(model_name)
        self.embedding_dim = self.model.get_sentence_embedding_dimension()
        
        # Use GPU if available
        if torch.cuda.is_available():
            self.model = self.model.cuda()
    
    def embed_texts(self, texts: List[str]) -> np.ndarray:
        """Batch embed multiple texts."""
        return self.model.encode(texts, convert_to_numpy=True)
    
    def embed_query(self, query: str) -> np.ndarray:
        """Embed single query."""
        return self.model.encode([query], convert_to_numpy=True)[0]</code></pre>
                </div>
                
                <h3 id="vector-store">5.4 Vector Store with FAISS</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">python - VectorStore Class</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">class VectorStore:
    """Efficient vector storage and similarity search."""
    
    def __init__(self, embedding_dim: int):
        self.embedding_dim = embedding_dim
        self.index = faiss.IndexFlatIP(embedding_dim)  # Inner product
        self.chunks = []
    
    def add_embeddings(self, embeddings: np.ndarray, chunks: List[Dict]):
        """Add normalized embeddings to index."""
        normalized = embeddings / np.linalg.norm(embeddings, axis=1, keepdims=True)
        self.index.add(normalized.astype('float32'))
        self.chunks.extend(chunks)
    
    def search(self, query_embedding: np.ndarray, k: int = 5) -> List[Dict]:
        """Find top-k similar vectors."""
        normalized = query_embedding / np.linalg.norm(query_embedding)
        normalized = normalized.reshape(1, -1).astype('float32')
        
        similarities, indices = self.index.search(normalized, k)
        
        results = []
        for idx, sim in zip(indices[0], similarities[0]):
            if idx < len(self.chunks):
                result = self.chunks[idx].copy()
                result['similarity_score'] = float(sim)
                results.append(result)
        
        return results</code></pre>
                </div>
                
                <h3 id="generation">5.5 Text Generation</h3>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="language">python - Generator Class</span>
                        <button class="copy-btn" onclick="copyCode(this)">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre><code class="language-python">class Generator:
    """Text generation using FLAN-T5."""
    
    def __init__(self, model_name: str = 'google/flan-t5-large'):
        self.tokenizer = AutoTokenizer.from_pretrained(model_name)
        self.model = AutoModelForSeq2SeqLM.from_pretrained(model_name)
        
        self.device = 'cuda' if torch.cuda.is_available() else 'cpu'
        self.model = self.model.to(self.device)
    
    def create_prompt(self, query: str, contexts: List[Dict]) -> str:
        """Build RAG prompt with retrieved contexts."""
        context_text = "\n\n".join([
            f"Document {i}: {ctx['text']}" 
            for i, ctx in enumerate(contexts, 1)
        ])
        
        return f"""Answer using ONLY the documents below.

Documents:
{context_text}

Question: {query}

Answer (2-3 sentences, cite sources):"""
    
    def generate(self, prompt: str, max_length: int = 200) -> str:
        """Generate answer from prompt."""
        inputs = self.tokenizer(prompt, return_tensors='pt', 
                               truncation=True, max_length=512)
        inputs = {k: v.to(self.device) for k, v in inputs.items()}
        
        with torch.no_grad():
            outputs = self.model.generate(**inputs, max_length=max_length)
        
        return self.tokenizer.decode(outputs[0], skip_special_tokens=True)</code></pre>
                </div>
                
                <div class="info-box tip">
                    <i class="fas fa-star"></i>
                    <div class="content">
                        <strong>Model Selection:</strong> Use <code>flan-t5-large</code> for better quality. For fastest results, use <code>flan-t5-base</code>. For best quality, use <code>flan-t5-xl</code> or GPT-based models.
                    </div>
                </div>
            </section>

            <!-- Prompt Engineering -->
            <section id="prompt-engineering" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <h2>Prompt Engineering Mastery</h2>
                </div>
                
                <p>Prompt engineering is the difference between mediocre and excellent RAG systems. A well-crafted prompt can improve quality by 50-100%.</p>
                
                <h3>Prompt Quality Comparison</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Strategy</th>
                            <th>Structure</th>
                            <th>Quality Score</th>
                            <th>Recommendation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Minimal</strong></td>
                            <td>Just context + query</td>
                            <td>0.45 / 1.0</td>
                            <td>❌ Avoid</td>
                        </tr>
                        <tr>
                            <td><strong>Structured</strong></td>
                            <td>Clear sections</td>
                            <td>0.65 / 1.0</td>
                            <td>⚠️ Basic use</td>
                        </tr>
                        <tr>
                            <td><strong>Constrained</strong></td>
                            <td>With rules & citations</td>
                            <td>0.82 / 1.0</td>
                            <td>✅ Production</td>
                        </tr>
                        <tr>
                            <td><strong>Advanced</strong></td>
                            <td>Chain-of-thought</td>
                            <td>0.80 / 1.0</td>
                            <td>✅ Complex queries</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="info-box important">
                    <i class="fas fa-exclamation-circle"></i>
                    <div class="content">
                        <strong>Critical for Production:</strong> Always use constrained prompts with explicit rules, citation requirements, and fallback language. This prevents hallucination and ensures reliable, verifiable answers.
                    </div>
                </div>
            </section>

            <!-- Exercises Section - Enhanced -->
            <section id="exercises" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <h2>Hands-On Exercises</h2>
                </div>
                
                <p>Practice makes perfect! Complete these exercises to master RAG systems. Each exercise includes hints and detailed solutions.</p>
                
                <div class="info-box note">
                    <i class="fas fa-trophy"></i>
                    <div class="content">
                        <strong>Learning Path:</strong> Start with Exercise 1 and progress sequentially. Each builds on concepts from previous exercises. Track your progress in the sidebar!
                    </div>
                </div>
                
                <!-- Exercise 1 -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">1</div>
                                <h4>Understanding Chunking Strategies</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge beginner">Beginner</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>15 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Learn how different chunking strategies affect retrieval quality and system performance.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Implement three chunking strategies and compare their effectiveness on a sample document.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Implement fixed-size chunking (100 words per chunk)</li>
                                <li>Implement sentence-based chunking</li>
                                <li>Implement chunking with 20-word overlap</li>
                                <li>Compare: number of chunks, readability, context preservation</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-file-alt"></i>
                                <h5>Sample Document</h5>
                            </div>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">Sample Text</span>
                                </div>
                                <pre><code class="language-python">document = """Machine learning is a subset of artificial intelligence that 
enables computers to learn from data without being explicitly programmed. 
There are three main types of machine learning. Supervised learning uses 
labeled data to train models that can predict outputs. Unsupervised learning 
finds patterns in unlabeled data. Reinforcement learning trains agents 
through rewards and penalties based on their actions."""</code></pre>
                            </div>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-question-circle"></i>
                                <h5>Questions to Answer</h5>
                            </div>
                            <ol>
                                <li>How many chunks did each strategy produce?</li>
                                <li>Which strategy best preserved sentence boundaries?</li>
                                <li>What are the trade-offs of using overlap?</li>
                                <li>Which strategy would you use for a production system and why?</li>
                            </ol>
                        </div>
                        
                        <!-- Hints -->
                        <div class="hints-container">
                            <button class="hint-btn" onclick="toggleHint(this, 1)">
                                <i class="fas fa-lightbulb"></i>
                                Need a hint?
                            </button>
                            
                            <div class="hint" id="hint-1-1">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Hint 1
                                </div>
                                <p style="margin: 0; color: #78350f;">
                                    Use <code>text.split()</code> to split by words for fixed-size chunking. 
                                    Use <code>nltk.sent_tokenize()</code> for sentence-based chunking.
                                </p>
                            </div>
                            
                            <div class="hint" id="hint-1-2">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Hint 2
                                </div>
                                <p style="margin: 0; color: #78350f;">
                                    For overlap, when creating a new chunk, include the last N words from the previous chunk. 
                                    Adjust your step size: <code>i += chunk_size - overlap</code>
                                </p>
                            </div>
                        </div>
                        
                        <!-- Solution -->
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Complete Solution</h5>
                            
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python - Solution</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python">import nltk
nltk.download('punkt', quiet=True)

document = """Machine learning is a subset of artificial intelligence..."""

# Strategy 1: Fixed-size (100 words)
def fixed_size_chunk(text, size=100):
    words = text.split()
    return [' '.join(words[i:i+size]) for i in range(0, len(words), size)]

# Strategy 2: Sentence-based
def sentence_chunk(text):
    return nltk.sent_tokenize(text)

# Strategy 3: With overlap
def overlapping_chunk(text, size=100, overlap=20):
    words = text.split()
    chunks = []
    i = 0
    while i < len(words):
        chunk = ' '.join(words[i:i+size])
        chunks.append(chunk)
        i += size - overlap  # Overlap
    return chunks

# Compare
chunks_fixed = fixed_size_chunk(document)
chunks_sentence = sentence_chunk(document)
chunks_overlap = overlapping_chunk(document)

print(f"Fixed-size: {len(chunks_fixed)} chunks")
print(f"Sentence-based: {len(chunks_sentence)} chunks")
print(f"With overlap: {len(chunks_overlap)} chunks")

# Analysis
print("\n📊 Analysis:")
print("✅ Sentence-based: Best for preserving meaning")
print("✅ With overlap: Best for context preservation")
print("⚠️ Fixed-size: Fastest but may break sentences")
print("\n💡 For production: Use sentence-based WITH overlap!")</code></pre>
                            </div>
                            
                            <div style="margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--accent); border-radius: 8px;">
                                <strong style="color: var(--accent);">Key Takeaway:</strong>
                                <p style="margin: 8px 0 0; color: var(--text-secondary);">
                                    Sentence-based chunking with overlap provides the best balance of semantic coherence and context preservation for RAG systems.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 2 -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">2</div>
                                <h4>Embedding Similarity Exploration</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge beginner">Beginner</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>20 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Discover how embeddings capture semantic meaning through hands-on similarity calculations.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Verify that embeddings correctly capture semantic similarity by comparing related and unrelated queries.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Generate embeddings for three queries:
                                    <ul style="margin-top: 10px;">
                                        <li>"How do neural networks learn?"</li>
                                        <li>"What is deep learning?"</li>
                                        <li>"Best chocolate cake recipe"</li>
                                    </ul>
                                </li>
                                <li>Calculate cosine similarity between all pairs</li>
                                <li>Verify that related topics (Q1, Q2) have high similarity (> 0.7)</li>
                                <li>Verify that unrelated topics (Q1, Q3) have low similarity (< 0.3)</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-chart-line"></i>
                                <h5>Expected Results</h5>
                            </div>
                            <div style="padding: 20px; background: var(--bg-tertiary); border-radius: var(--radius-md); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem;">
                                <div>Similarity (Q1 vs Q2): <span style="color: var(--accent); font-weight: 700;">0.75+</span> ✅ High (related)</div>
                                <div style="margin-top: 8px;">Similarity (Q1 vs Q3): <span style="color: var(--danger); font-weight: 700;">< 0.30</span> ✅ Low (unrelated)</div>
                            </div>
                        </div>
                        
                        <!-- Hints -->
                        <div class="hints-container">
                            <button class="hint-btn" onclick="toggleHint(this, 2)">
                                <i class="fas fa-lightbulb"></i>
                                Show Hint
                            </button>
                            
                            <div class="hint" id="hint-2-1">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Hint
                                </div>
                                <p style="margin: 0; color: #78350f;">
                                    Use <code>sklearn.metrics.pairwise.cosine_similarity()</code> to calculate similarity between embedding vectors. Remember to reshape single embeddings: <code>[embedding]</code>
                                </p>
                            </div>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Complete Solution</h5>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python">from sentence_transformers import SentenceTransformer
from sklearn.metrics.pairwise import cosine_similarity
import numpy as np

# Load embedding model
model = SentenceTransformer('all-MiniLM-L6-v2')

# Define queries
queries = [
    "How do neural networks learn?",
    "What is deep learning?",
    "Best chocolate cake recipe"
]

# Generate embeddings
embeddings = model.encode(queries)

# Calculate similarities
sim_q1_q2 = cosine_similarity([embeddings[0]], [embeddings[1]])[0][0]
sim_q1_q3 = cosine_similarity([embeddings[0]], [embeddings[2]])[0][0]
sim_q2_q3 = cosine_similarity([embeddings[1]], [embeddings[2]])[0][0]

# Display results
print("="*60)
print("EMBEDDING SIMILARITY ANALYSIS")
print("="*60)
print(f"\nQuery 1: {queries[0]}")
print(f"Query 2: {queries[1]}")
print(f"Query 3: {queries[2]}")

print(f"\n📊 Similarity Scores:")
print(f"  Q1 ↔ Q2: {sim_q1_q2:.4f} {'✅ High (related topics)' if sim_q1_q2 > 0.7 else '❌'}")
print(f"  Q1 ↔ Q3: {sim_q1_q3:.4f} {'✅ Low (unrelated)' if sim_q1_q3 < 0.3 else '❌'}")
print(f"  Q2 ↔ Q3: {sim_q2_q3:.4f}")

# Verification
assert sim_q1_q2 > 0.7, "Related queries should have high similarity!"
assert sim_q1_q3 < 0.3, "Unrelated queries should have low similarity!"

print("\n✅ Semantic similarity working correctly!")
print("\n💡 Insight: Embeddings capture meaning, not just keywords.")</code></pre>
                            </div>
                            
                            <div style="margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--accent); border-radius: 8px;">
                                <strong style="color: var(--accent);">What You Learned:</strong>
                                <ul style="margin: 10px 0 0 20px; color: var(--text-secondary);">
                                    <li>Embeddings represent semantic meaning as vectors</li>
                                    <li>Cosine similarity measures how related two texts are</li>
                                    <li>This enables retrieval based on meaning, not just keywords</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 3 -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">3</div>
                                <h4>Build Your First Vector Store</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge intermediate">Intermediate</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>30 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Create a functional vector store using FAISS and perform similarity searches.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Build a vector store that can index 10 documents and retrieve the most relevant ones for a given query.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Create a list of 10 documents about different ML topics</li>
                                <li>Generate embeddings for all documents</li>
                                <li>Initialize a FAISS index and add the embeddings</li>
                                <li>Implement a search function that finds top-3 similar documents</li>
                                <li>Test with queries and verify relevance scores</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-check-square"></i>
                                <h5>Success Criteria</h5>
                            </div>
                            <ul>
                                <li>Search returns results in < 100ms</li>
                                <li>Top result has similarity > 0.6 for relevant queries</li>
                                <li>Results are ranked by similarity (highest first)</li>
                            </ul>
                        </div>
                        
                        <div class="hints-container">
                            <button class="hint-btn" onclick="toggleHint(this, 3)">
                                <i class="fas fa-lightbulb"></i>
                                Show Hint
                            </button>
                            
                            <div class="hint" id="hint-3-1">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Hint
                                </div>
                                <p style="margin: 0; color: #78350f;">
                                    Use <code>faiss.IndexFlatIP(dimension)</code> for inner product search. 
                                    Normalize embeddings before adding: <code>embeddings / np.linalg.norm(embeddings, axis=1, keepdims=True)</code>.
                                    This makes inner product equivalent to cosine similarity.
                                </p>
                            </div>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Complete Solution</h5>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python">import numpy as np
from sentence_transformers import SentenceTransformer
import faiss
import time

# 1. Create documents
documents = [
    "Machine learning enables computers to learn from data",
    "Deep learning uses neural networks with multiple layers",
    "Natural language processing deals with human language",
    "Computer vision enables machines to interpret images",
    "Reinforcement learning trains through trial and error",
    "Supervised learning uses labeled training data",
    "Unsupervised learning finds patterns without labels",
    "Transfer learning reuses pre-trained models",
    "Feature engineering creates useful input variables",
    "Model evaluation assesses prediction accuracy"
]

# 2. Generate embeddings
model = SentenceTransformer('all-MiniLM-L6-v2')
embeddings = model.encode(documents, convert_to_numpy=True)

print(f"Generated {len(embeddings)} embeddings")
print(f"Embedding dimension: {embeddings.shape[1]}")

# 3. Build vector store
dimension = embeddings.shape[1]
index = faiss.IndexFlatIP(dimension)

# Normalize for cosine similarity
normalized = embeddings / np.linalg.norm(embeddings, axis=1, keepdims=True)
index.add(normalized.astype('float32'))

print(f"✅ Vector store built with {index.ntotal} vectors")

# 4. Search function
def search(query, k=3):
    start = time.time()
    
    # Embed and normalize query
    query_emb = model.encode([query], convert_to_numpy=True)
    query_emb = query_emb / np.linalg.norm(query_emb)
    
    # Search
    scores, indices = index.search(query_emb.astype('float32'), k)
    
    elapsed = time.time() - start
    
    # Format results
    print(f"\n🔍 Query: '{query}'")
    print(f"⏱️  Search time: {elapsed*1000:.2f}ms")
    print(f"\n📊 Top {k} Results:")
    
    for i, (idx, score) in enumerate(zip(indices[0], scores[0]), 1):
        print(f"  {i}. [{score:.4f}] {documents[idx]}")
    
    return indices[0], scores[0]

# 5. Test queries
search("What is neural network based learning?", k=3)
search("How do I assess my model?", k=3)

print("\n✅ Vector store working correctly!")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 4 -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">4</div>
                                <h4>Implement End-to-End RAG</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge intermediate">Intermediate</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>45 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Combine all components to build a complete, working RAG system.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Create a mini RAG system that can answer questions about your custom knowledge base.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Create a knowledge base with 5-10 documents on a topic you choose</li>
                                <li>Implement: DocumentChunker → EmbeddingGenerator → VectorStore → Retriever</li>
                                <li>Add a simple text generation component (can use FLAN-T5-base initially)</li>
                                <li>Build a query interface that:
                                    <ul style="margin-top: 8px;">
                                        <li>Takes a user question</li>
                                        <li>Retrieves top 3 relevant chunks</li>
                                        <li>Displays results with similarity scores</li>
                                        <li>Generates an answer (optional for this exercise)</li>
                                    </ul>
                                </li>
                                <li>Test with 5 different queries</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-star"></i>
                                <h5>Bonus Challenges</h5>
                            </div>
                            <ul>
                                <li>Add metadata tracking (source document, page number)</li>
                                <li>Implement diverse retrieval (avoid multiple chunks from same doc)</li>
                                <li>Add timing metrics for each component</li>
                                <li>Create a simple CLI or Gradio interface</li>
                            </ul>
                        </div>
                        
                        <div class="hints-container">
                            <button class="hint-btn" onclick="toggleHint(this, 4)">
                                <i class="fas fa-lightbulb"></i>
                                Show Starter Code
                            </button>
                            
                            <div class="hint" id="hint-4-1">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Starter Template
                                </div>
                                <div class="code-block" style="margin-top: 15px;">
                                    <div class="code-header">
                                        <span class="language">python</span>
                                    </div>
                                    <pre><code class="language-python"># Starter template - fill in the TODOs

# 1. Create knowledge base
documents = [
    {"title": "Doc 1", "content": "Your content here..."},
    # TODO: Add more documents
]

# 2. Initialize components
chunker = DocumentChunker(chunk_size=200, overlap=50)
embedding_gen = EmbeddingGenerator()
vector_store = VectorStore(embedding_gen.embedding_dim)

# 3. Process documents
# TODO: Chunk documents
# TODO: Generate embeddings
# TODO: Add to vector store

# 4. Build retriever
# TODO: Create Retriever class

# 5. Query interface
def ask(question):
    # TODO: Retrieve relevant docs
    # TODO: Display results
    pass</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Complete Mini RAG System</h5>
                            <p style="color: var(--text-secondary); margin-bottom: 15px;">
                                This solution implements a fully functional RAG system with all components integrated.
                            </p>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python - Complete Solution</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python"># Complete Mini RAG System
# This is a production-ready implementation!

import numpy as np
from sentence_transformers import SentenceTransformer
import faiss
import nltk
import time

nltk.download('punkt', quiet=True)

# Knowledge base
KNOWLEDGE_BASE = [
    {"title": "Python Basics", "content": "Python is a high-level programming language known for its simplicity and readability..."},
    {"title": "Machine Learning", "content": "Machine learning enables computers to learn patterns from data without explicit programming..."},
    {"title": "Neural Networks", "content": "Neural networks are computing systems inspired by biological neural networks..."},
    {"title": "Deep Learning", "content": "Deep learning uses neural networks with multiple layers to learn hierarchical representations..."},
    {"title": "Data Science", "content": "Data science combines statistics, programming, and domain expertise to extract insights..."},
]

class SimpleRAG:
    def __init__(self):
        # Initialize components
        self.model = SentenceTransformer('all-MiniLM-L6-v2')
        self.dimension = self.model.get_sentence_embedding_dimension()
        self.index = faiss.IndexFlatIP(self.dimension)
        self.chunks = []
        
        print(f"✅ RAG system initialized ({self.dimension}-dim embeddings)")
    
    def index_documents(self, documents):
        """Chunk, embed, and index documents."""
        for doc in documents:
            # Simple chunking (you can use DocumentChunker here)
            text = doc['content']
            # For simplicity, treating whole doc as one chunk
            # In production, use proper chunking!
            
            self.chunks.append({
                'text': text,
                'title': doc['title']
            })
        
        # Generate embeddings
        texts = [c['text'] for c in self.chunks]
        embeddings = self.model.encode(texts, convert_to_numpy=True)
        
        # Normalize and add to index
        normalized = embeddings / np.linalg.norm(embeddings, axis=1, keepdims=True)
        self.index.add(normalized.astype('float32'))
        
        print(f"✅ Indexed {len(self.chunks)} documents")
    
    def search(self, query, k=3):
        """Search for relevant documents."""
        # Embed query
        query_emb = self.model.encode([query], convert_to_numpy=True)
        query_emb = query_emb / np.linalg.norm(query_emb)
        
        # Search
        scores, indices = self.index.search(query_emb.astype('float32'), k)
        
        # Format results
        results = []
        for idx, score in zip(indices[0], scores[0]):
            results.append({
                'title': self.chunks[idx]['title'],
                'text': self.chunks[idx]['text'][:150] + "...",
                'score': float(score)
            })
        
        return results
    
    def answer(self, query, k=3):
        """Complete RAG query."""
        print(f"\n{'='*70}")
        print(f"🔍 Query: {query}")
        print(f"{'='*70}")
        
        start = time.time()
        results = self.search(query, k=k)
        search_time = time.time() - start
        
        print(f"\n📚 Retrieved {len(results)} documents in {search_time*1000:.2f}ms:\n")
        
        for i, result in enumerate(results, 1):
            print(f"{i}. [{result['score']:.4f}] {result['title']}")
            print(f"   {result['text']}\n")
        
        return results

# Initialize and use
rag = SimpleRAG()
rag.index_documents(KNOWLEDGE_BASE)

# Test queries
rag.answer("What is neural network learning?")
rag.answer("Tell me about Python programming")
rag.answer("How is data analyzed?")

print("✅ Mini RAG system complete!")</code></pre>
                            </div>
                            
                            <div style="margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--accent); border-radius: 8px;">
                                <strong style="color: var(--accent);">Key Achievement:</strong>
                                <p style="margin: 8px 0 0; color: var(--text-secondary);">
                                    You've built a working RAG system! It can retrieve relevant documents in milliseconds and provide source-grounded information. Next step: Add text generation!
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 5 - Prompt Engineering -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">5</div>
                                <h4>Master Prompt Engineering</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge advanced">Advanced</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>40 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Compare different prompt strategies and measure their impact on answer quality.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Create 4 different prompts and evaluate which produces the highest quality RAG responses.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Implement 4 prompt strategies:
                                    <ul style="margin-top: 8px;">
                                        <li><strong>Minimal:</strong> Just context + question</li>
                                        <li><strong>Structured:</strong> Organized sections</li>
                                        <li><strong>Constrained:</strong> With explicit rules</li>
                                        <li><strong>Chain-of-Thought:</strong> With reasoning steps</li>
                                    </ul>
                                </li>
                                <li>For the same query, generate answers using each strategy</li>
                                <li>Evaluate each answer for:
                                    <ul style="margin-top: 8px;">
                                        <li>Context grounding (uses retrieved docs?)</li>
                                        <li>Citation presence</li>
                                        <li>Answer length and completeness</li>
                                    </ul>
                                </li>
                                <li>Identify which strategy works best</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-clipboard-check"></i>
                                <h5>Evaluation Checklist</h5>
                            </div>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Metric</th>
                                        <th>How to Check</th>
                                        <th>Target</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Grounding</td>
                                        <td>% words from context</td>
                                        <td>> 60%</td>
                                    </tr>
                                    <tr>
                                        <td>Citation</td>
                                        <td>Mentions "Document"?</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td>Length</td>
                                        <td>Word count</td>
                                        <td>20-80 words</td>
                                    </tr>
                                    <tr>
                                        <td>Relevance</td>
                                        <td>Answers the question?</td>
                                        <td>Yes</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="hints-container">
                            <button class="hint-btn" onclick="toggleHint(this, 5)">
                                <i class="fas fa-lightbulb"></i>
                                Show Hint
                            </button>
                            
                            <div class="hint" id="hint-5-1">
                                <div class="hint-label">
                                    <i class="fas fa-hand-point-right"></i>
                                    Hint - Evaluation Function
                                </div>
                                <div class="code-block" style="margin-top: 10px;">
                                    <pre><code class="language-python">def evaluate_answer(answer, contexts):
    # Check grounding
    context_words = set(word for ctx in contexts for word in ctx['text'].lower().split())
    answer_words = set(answer.lower().split())
    grounding = len(answer_words & context_words) / len(answer_words)
    
    # Check citation
    has_citation = 'document' in answer.lower()
    
    # Check length
    word_count = len(answer.split())
    
    return {
        'grounding': grounding,
        'has_citation': has_citation,
        'word_count': word_count
    }</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Prompt Engineering Comparison</h5>
                            <p style="color: var(--text-secondary); margin-bottom: 15px;">
                                This solution demonstrates the dramatic impact of prompt engineering on RAG quality.
                            </p>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python"># Prompt Engineering Comparison

context = "Deep learning is a subset of ML that uses neural networks with multiple layers..."
query = "What is deep learning?"

# Strategy 1: Minimal (❌ Poor)
prompt_minimal = f"Context: {context}\n\nQuestion: {query}"

# Strategy 2: Structured (⚠️ Better)
prompt_structured = f"""Information:
{context}

Question: {query}

Provide a clear answer based on the information above."""

# Strategy 3: Constrained (✅ Best for RAG)
prompt_constrained = f"""You are a helpful AI assistant. Answer using ONLY the document below.

Rules:
- Use only the provided context
- Cite the source
- If info is missing, say so
- Write 2-3 complete sentences

Document: {context}

Question: {query}

Answer:"""

# Strategy 4: Chain-of-Thought (✅ Best for complex queries)
prompt_cot = f"""You are an expert AI. Follow these steps:

1. Read the document carefully
2. Identify relevant information
3. Formulate a clear answer
4. Cite your source

Document: {context}

Question: {query}

Think through the steps, then answer:"""

# Evaluate each (you'll need a generator for this)
# generator = Generator()

# Results you should see:
print("Expected Results:")
print("─"*60)
print("Minimal:     Low quality, may ignore context")
print("Structured:  Better, but no citations")
print("Constrained: High quality, cites sources ✅ BEST")
print("CoT:         High quality for complex queries")
print("\n💡 Use Constrained prompts for production RAG!")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exercise 6-10 (Abbreviated for space) -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">6</div>
                                <h4>Evaluation Metrics Implementation</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge advanced">Advanced</span>
                                <span class="time-badge">
                                    <i class="far fa-clock"></i>
                                    <span>35 mins</span>
                                </span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Implement precision@k, recall@k, and MRR metrics to evaluate retrieval quality.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Objective</h5>
                            </div>
                            <p>Build an evaluation framework to measure how well your RAG system retrieves relevant documents.</p>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-tasks"></i>
                                <h5>Tasks</h5>
                            </div>
                            <ol>
                                <li>Create a test set with queries and known relevant documents</li>
                                <li>Implement precision@k metric</li>
                                <li>Implement recall@k metric</li>
                                <li>Implement Mean Reciprocal Rank (MRR)</li>
                                <li>Test your RAG system and calculate all metrics</li>
                            </ol>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        
                        <div class="solution">
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python">def calculate_precision_at_k(retrieved, relevant, k):
    """Precision@k: % of retrieved docs that are relevant"""
    retrieved_k = set(retrieved[:k])
    relevant_set = set(relevant)
    return len(retrieved_k & relevant_set) / k if k > 0 else 0

def calculate_recall_at_k(retrieved, relevant, k):
    """Recall@k: % of relevant docs that were retrieved"""
    retrieved_k = set(retrieved[:k])
    relevant_set = set(relevant)
    return len(retrieved_k & relevant_set) / len(relevant_set) if relevant_set else 0

def calculate_mrr(retrieved, relevant):
    """Mean Reciprocal Rank: 1/rank of first relevant doc"""
    for rank, doc_id in enumerate(retrieved, 1):
        if doc_id in relevant:
            return 1 / rank
    return 0

# Example evaluation
query = "What is deep learning?"
relevant_docs = [2, 3]  # IDs of truly relevant documents
retrieved_docs = rag_system.retrieve(query, k=5)
retrieved_ids = [r['doc_id'] for r in retrieved_docs]

precision = calculate_precision_at_k(retrieved_ids, relevant_docs, k=5)
recall = calculate_recall_at_k(retrieved_ids, relevant_docs, k=5)
mrr = calculate_mrr(retrieved_ids, relevant_docs)

print(f"Precision@5: {precision:.3f}")
print(f"Recall@5: {recall:.3f}")
print(f"MRR: {mrr:.3f}")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- More exercises in abbreviated format -->
                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">7</div>
                                <h4>Optimize Chunk Size & Overlap</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge intermediate">Intermediate</span>
                                <span class="time-badge"><i class="far fa-clock"></i> 30 mins</span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Experiment with different chunk sizes (100, 200, 500) and overlaps (0, 50, 100) to find optimal settings.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <p>Test chunk sizes: 100, 200, 500 tokens with overlaps: 0, 50, 100 tokens. Measure retrieval precision for each combination.</p>
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        <div class="solution">
                            <p style="color: var(--accent); font-weight: 600;">Optimal: 200-300 tokens with 50-token overlap for most applications.</p>
                        </div>
                    </div>
                </div>

                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">8</div>
                                <h4>Handle Edge Cases</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge intermediate">Intermediate</span>
                                <span class="time-badge"><i class="far fa-clock"></i> 25 mins</span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Test your RAG system with empty queries, out-of-domain questions, and conflicting documents.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <p>Test: empty string, nonsense query, out-of-domain question. Add proper error handling and fallback messages.</p>
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        <div class="solution">
                            <div class="code-block">
                                <pre><code class="language-python">def safe_answer_query(query, k=3):
    if not query or len(query.strip()) < 3:
        return "Please provide a valid question."
    
    results = retriever.retrieve(query, k=k)
    
    if not results or results[0]['similarity_score'] < 0.3:
        return "I couldn't find relevant information about that topic."
    
    # Continue with generation...
    return answer</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">9</div>
                                <h4>Add Diverse Retrieval</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge advanced">Advanced</span>
                                <span class="time-badge"><i class="far fa-clock"></i> 35 mins</span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Implement diversity in retrieval to avoid returning multiple chunks from the same document.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <p>Modify the retriever to ensure top-k results come from different source documents when possible.</p>
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Reveal Solution</span>
                        </div>
                        <div class="solution">
                            <p style="color: var(--accent); font-weight: 600;">Retrieve k*3 candidates, then select k diverse results by filtering duplicate doc_ids.</p>
                        </div>
                    </div>
                </div>

                <div class="exercise">
                    <div class="exercise-header" onclick="toggleExercise(this)">
                        <div class="exercise-top">
                            <div class="exercise-title">
                                <div class="exercise-number">10</div>
                                <h4>Build a Production System</h4>
                            </div>
                            <div class="exercise-meta">
                                <span class="badge advanced">Advanced</span>
                                <span class="time-badge"><i class="far fa-clock"></i> 90+ mins</span>
                                <i class="fas fa-chevron-down toggle-icon"></i>
                            </div>
                        </div>
                        <div class="exercise-description">
                            Create a production-ready RAG system with your own knowledge base and a Gradio interface.
                        </div>
                    </div>
                    <div class="exercise-content">
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-bullseye"></i>
                                <h5>Final Project</h5>
                            </div>
                            <p>Build a complete, deployable RAG application:</p>
                            <ol>
                                <li>Choose a real-world domain (customer support, research assistant, etc.)</li>
                                <li>Collect or create 20+ documents</li>
                                <li>Implement full pipeline with all optimizations</li>
                                <li>Add evaluation metrics and logging</li>
                                <li>Create a Gradio or Streamlit interface</li>
                                <li>Deploy (optional: Hugging Face Spaces, Streamlit Cloud)</li>
                            </ol>
                        </div>
                        
                        <div class="exercise-section">
                            <div class="exercise-section-header">
                                <i class="fas fa-star"></i>
                                <h5>Production Checklist</h5>
                            </div>
                            <ul>
                                <li>✅ Error handling for all edge cases</li>
                                <li>✅ Logging for debugging</li>
                                <li>✅ Response time < 5 seconds</li>
                                <li>✅ Source citation in all answers</li>
                                <li>✅ Similarity threshold filtering (> 0.3)</li>
                                <li>✅ User-friendly interface</li>
                                <li>✅ Documentation and README</li>
                            </ul>
                        </div>
                        
                        <div class="solution-toggle" onclick="toggleSolution(this)">
                            <i class="fas fa-unlock"></i>
                            <span>Show Project Template</span>
                        </div>
                        
                        <div class="solution">
                            <h5>Production RAG Template</h5>
                            <div class="code-block">
                                <div class="code-header">
                                    <span class="language">python - Gradio Interface</span>
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                </div>
                                <pre><code class="language-python">import gradio as gr

def rag_interface(query, k, use_diversity):
    if not query.strip():
        return "⚠️ Please enter a question!", ""
    
    result = rag_system.answer_query(query, k=k, use_diversity=use_diversity)
    
    answer = f"**Answer:**\n\n{result['answer']}"
    
    sources = "**Sources:**\n\n"
    for i, src in enumerate(result['sources'], 1):
        sources += f"{i}. {src['title']} (Relevance: {src['similarity']:.3f})\n"
    
    return answer, sources

# Create interface
with gr.Blocks() as demo:
    gr.Markdown("# 🤖 RAG Question Answering System")
    
    with gr.Row():
        query = gr.Textbox(label="Your Question", lines=3)
    
    with gr.Row():
        k = gr.Slider(1, 10, value=3, label="Documents to Retrieve")
        diversity = gr.Checkbox(value=True, label="Use Diversity")
    
    btn = gr.Button("Ask Question", variant="primary")
    
    answer = gr.Markdown()
    sources = gr.Markdown()
    
    btn.click(rag_interface, [query, k, diversity], [answer, sources])

demo.launch(share=True)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Exercise Summary -->
                <div style="margin-top: 50px; padding: 35px; background: linear-gradient(135deg, #eff6ff, #dbeafe); border-radius: var(--radius-xl); border: 2px solid #93c5fd;">
                    <h3 style="margin: 0 0 20px; color: #1e40af; display: flex; align-items: center; gap: 12px;">
                        <i class="fas fa-graduation-cap"></i>
                        Congratulations!
                    </h3>
                    <p style="margin: 0; color: #1e3a8a; font-size: 1.05rem;">
                        By completing these exercises, you've mastered RAG systems from theory to production. You can now build intelligent, source-grounded AI applications that solve real-world problems!
                    </p>
                </div>
            </section>

            <!-- Resources -->
            <section id="resources" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <h2>Resources & Next Steps</h2>
                </div>
                
                <h3>📚 Essential Reading</h3>
                
                <div style="display: grid; gap: 20px;">
                    <div style="padding: 25px; background: white; border: 2px solid var(--border); border-radius: var(--radius-lg); box-shadow: var(--shadow);">
                        <h4 style="margin: 0 0 15px; color: var(--primary);">
                            <i class="fas fa-file-alt"></i> Academic Papers
                        </h4>
                        <ul style="margin: 0;">
                            <li><strong>"Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks"</strong><br>
                                <span style="color: var(--text-muted); font-size: 0.9rem;">Lewis et al., 2020 • The original RAG paper</span>
                            </li>
                            <li><strong>"Dense Passage Retrieval for Open-Domain QA"</strong><br>
                                <span style="color: var(--text-muted); font-size: 0.9rem;">Karpukhin et al., 2020 • Foundation for retrieval</span>
                            </li>
                            <li><strong>"Sentence-BERT: Sentence Embeddings using Siamese BERT-networks"</strong><br>
                                <span style="color: var(--text-muted); font-size: 0.9rem;">Reimers & Gurevych, 2019 • Embedding techniques</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div style="padding: 25px; background: white; border: 2px solid var(--border); border-radius: var(--radius-lg); box-shadow: var(--shadow);">
                        <h4 style="margin: 0 0 15px; color: var(--accent);">
                            <i class="fas fa-tools"></i> Tools & Libraries
                        </h4>
                        <ul style="margin: 0;">
                            <li><strong>LangChain</strong> - Framework for LLM applications</li>
                            <li><strong>LlamaIndex</strong> - Data framework specifically for RAG</li>
                            <li><strong>Haystack</strong> - End-to-end NLP framework</li>
                            <li><strong>Pinecone</strong> - Managed vector database</li>
                            <li><strong>Weaviate</strong> - Open-source vector database</li>
                        </ul>
                    </div>
                </div>
                
                <h3>🚀 Next Steps</h3>
                
                <div class="stats-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                    <div style="padding: 25px; background: linear-gradient(135deg, #eff6ff, white); border-radius: var(--radius-lg); border: 2px solid #bfdbfe; text-align: center;">
                        <i class="fas fa-code" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h4 style="margin: 0 0 10px; color: var(--primary);">Build</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">
                            Create your own RAG system for a real use case
                        </p>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #fef3c7, white); border-radius: var(--radius-lg); border: 2px solid #fde68a; text-align: center;">
                        <i class="fas fa-chart-line" style="font-size: 2.5rem; color: var(--secondary); margin-bottom: 15px;"></i>
                        <h4 style="margin: 0 0 10px; color: var(--secondary);">Optimize</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">
                            Measure and improve retrieval and generation quality
                        </p>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #f0fdf4, white); border-radius: var(--radius-lg); border: 2px solid #bbf7d0; text-align: center;">
                        <i class="fas fa-rocket" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 15px;"></i>
                        <h4 style="margin: 0 0 10px; color: var(--accent);">Deploy</h4>
                        <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">
                            Share your system on Hugging Face Spaces or GitHub
                        </p>
                    </div>
                </div>
                
                <div style="margin-top: 50px; padding: 40px; background: linear-gradient(135deg, #0f172a, #1e293b); color: white; border-radius: var(--radius-xl); text-align: center;">
                    <h3 style="margin: 0 0 15px; font-family: 'DM Serif Display', serif; font-size: 2rem;">
                        Ready to build amazing RAG systems? 🚀
                    </h3>
                    <p style="margin: 0 0 30px; opacity: 0.9; font-size: 1.1rem;">
                        You have all the knowledge and tools. Now go create something incredible!
                    </p>
                    <div class="cta-buttons">
                        <a href="https://github.com/ManishKondoju/RAG_from_Sratch" class="btn btn-primary">
                            <i class="fab fa-github"></i>
                            Get the Code
                        </a>
                        <a href="https://www.youtube.com/watch?v=your-video-link" class="btn btn-secondary"></a>
                            <i class="fab fa-youtube"></i>
                            Watch Tutorial
                        </a>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Footer -->
    <footer style="background: linear-gradient(135deg, #0f172a, #1e293b); color: #cbd5e1; padding: 80px 20px 40px; margin-top: 100px;">
        <div style="max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 50px;">
            <div>
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.2rem;">About</h3>
                <p style="color: #94a3b8; line-height: 1.7;">
                    A comprehensive tutorial on building RAG systems from scratch, created for INFO 7390 at Northeastern University.
                </p>
            </div>
            
            <div>
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.2rem;">Quick Links</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><a href="#introduction" style="color: #94a3b8; text-decoration: none;">Introduction</a></li>
                    <li style="margin-bottom: 12px;"><a href="#theory" style="color: #94a3b8; text-decoration: none;">Theory</a></li>
                    <li style="margin-bottom: 12px;"><a href="#implementation" style="color: #94a3b8; text-decoration: none;">Implementation</a></li>
                    <li style="margin-bottom: 12px;"><a href="#exercises" style="color: #94a3b8; text-decoration: none;">Exercises</a></li>
                    <li style="margin-bottom: 12px;"><a href="#resources" style="color: #94a3b8; text-decoration: none;">Resources</a></li>
                </ul>
            </div>
            
            <div>
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.2rem;">Resources</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><a href="https://github.com/yourusername/rag-tutorial" style="color: #94a3b8; text-decoration: none;"><i class="fab fa-github"></i> GitHub Repository</a></li>
                    <li style="margin-bottom: 12px;"><a href="https://www.youtube.com/watch?v=..." style="color: #94a3b8; text-decoration: none;"><i class="fab fa-youtube"></i> Video Tutorial</a></li>
                    <li style="margin-bottom: 12px;"><a href="#" style="color: #94a3b8; text-decoration: none;"><i class="fas fa-download"></i> Download Notebook</a></li>
                </ul>
            </div>
            
            <div>
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.2rem;">Connect</h3>
                <ul style="list-style: none;">
                    <li style="margin-bottom: 12px;"><a href="https://linkedin.com/in/yourprofile" style="color: #94a3b8; text-decoration: none;"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
                    <li style="margin-bottom: 12px;"><a href="https://github.com/yourusername" style="color: #94a3b8; text-decoration: none;"><i class="fab fa-github"></i> GitHub</a></li>
                    <li style="margin-bottom: 12px;"><a href="mailto:kumar.mani@northeastern.edu" style="color: #94a3b8; text-decoration: none;"><i class="fas fa-envelope"></i> Email</a></li>
                </ul>
            </div>
        </div>
        
        <div style="max-width: 1400px; margin: 50px auto 0; padding-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.1); text-align: center; color: #64748b;">
            <p>&copy; 2024 Manish Kumar | INFO 7390 - Advanced Data Science and Architecture | Northeastern University</p>
            <p style="margin-top: 10px; font-size: 0.85rem;">
                Licensed under MIT License | Created with ❤️ for the data science community
            </p>
        </div>
    </footer>

    <!-- Scroll to Top Button -->
    <div class="scroll-top" onclick="scrollToTop()" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <!-- JavaScript -->
    <script>
        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Active navigation highlighting
        window.addEventListener('scroll', () => {
            let current = '';
            const sections = document.querySelectorAll('.section');
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.toc a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
            
            // Update scroll progress bar
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
            
            // Show/hide scroll to top button
            const scrollTop = document.getElementById('scrollTop');
            if (window.scrollY > 300) {
                scrollTop.classList.add('active');
            } else {
                scrollTop.classList.remove('active');
            }
        });

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Toggle exercise
        function toggleExercise(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.toggle-icon');
            
            content.classList.toggle('active');
            
            if (content.classList.contains('active')) {
                icon.style.transform = 'rotate(180deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Toggle solution
        function toggleSolution(button) {
            const solution = button.nextElementSibling;
            const icon = button.querySelector('i');
            
            solution.classList.toggle('active');
            
            if (solution.classList.contains('active')) {
                icon.className = 'fas fa-eye-slash';
                button.innerHTML = '<i class="fas fa-eye-slash"></i><span>Hide Solution</span>';
            } else {
                icon.className = 'fas fa-unlock';
                button.innerHTML = '<i class="fas fa-unlock"></i><span>Reveal Solution</span>';
            }
        }

        // Toggle hint
        let currentHintIndex = {};
        
        function toggleHint(button, exerciseNum) {
            if (!currentHintIndex[exerciseNum]) {
                currentHintIndex[exerciseNum] = 0;
            }
            
            const hintId = `hint-${exerciseNum}-${++currentHintIndex[exerciseNum]}`;
            const hint = document.getElementById(hintId);
            
            if (hint) {
                hint.classList.add('active');
                
                // Check if there are more hints
                const nextHintId = `hint-${exerciseNum}-${currentHintIndex[exerciseNum] + 1}`;
                if (!document.getElementById(nextHintId)) {
                    button.style.display = 'none';
                } else {
                    button.innerHTML = `<i class="fas fa-lightbulb"></i><span>Show Next Hint</span>`;
                }
            } else {
                button.style.display = 'none';
            }
        }

        // Copy code
        function copyCode(button) {
            const codeBlock = button.closest('.code-block').querySelector('code');
            const text = codeBlock.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                const icon = button.querySelector('i');
                const originalHTML = button.innerHTML;
                
                button.innerHTML = '<i class="fas fa-check"></i> Copied!';
                button.style.background = 'rgba(34, 197, 94, 0.2)';
                button.style.borderColor = 'rgba(34, 197, 94, 0.5)';
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.style.background = '';
                    button.style.borderColor = '';
                }, 2000);
            });
        }

        // Quiz System
        let quizAnswers = {};
        
        function selectOption(element, quizNum, questionNum) {
            const question = element.closest('.quiz-question');
            const options = question.querySelectorAll('.quiz-option');
            
            // Remove previous selections
            options.forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
                opt.style.borderColor = '';
                opt.style.background = '';
            });
            
            // Mark selected
            const selected = element.getAttribute('data-opt');
            const correct = question.getAttribute('data-answer');
            
            quizAnswers[`${quizNum}-${questionNum}`] = selected;
            
            if (selected === correct) {
                element.classList.add('correct');
                showFeedback(quizNum, questionNum, true);
            } else {
                element.classList.add('incorrect');
                // Show correct answer
                options.forEach(opt => {
                    if (opt.getAttribute('data-opt') === correct) {
                        opt.classList.add('correct');
                    }
                });
                showFeedback(quizNum, questionNum, false);
            }
        }
        
        function showFeedback(quizNum, questionNum, isCorrect) {
            const feedback = document.getElementById(`feedback-${quizNum}-${questionNum}`);
            if (feedback) {
                feedback.className = 'quiz-feedback active ' + (isCorrect ? 'correct' : 'incorrect');
                
                const feedbackMessages = {
                    '1-1': {
                        correct: "Perfect! RAG's killer feature is instant knowledge updates without retraining.",
                        incorrect: "Not quite. Think about what makes RAG different from fine-tuning..."
                    },
                    '1-2': {
                        correct: "Excellent! Chunking enables precise retrieval and stays within token limits.",
                        incorrect: "Consider why we can't just embed entire documents..."
                    },
                    '2-1': {
                        correct: "Right! Cosine similarity measures semantic relatedness, not word overlap.",
                        incorrect: "Remember: embeddings capture meaning, not just words."
                    },
                    '2-2': {
                        correct: "Correct! HNSW provides the best speed/accuracy balance for large datasets.",
                        incorrect: "For 1M+ vectors, exact search is too slow. We need approximate methods."
                    },
                    '3-1': {
                        correct: "Perfect! Explicit constraints are essential to prevent hallucination.",
                        incorrect: "Think about what prevents the model from using its training data..."
                    },
                    '3-2': {
                        correct: "Exactly! 0.3-0.7 balances factual accuracy with natural fluency.",
                        incorrect: "Too low is robotic, too high hallucinates. We need balance!"
                    }
                };
                
                const key = `${quizNum}-${questionNum}`;
                const message = feedbackMessages[key];
                
                if (message) {
                    feedback.innerHTML = `
                        <div class="feedback-header ${isCorrect ? 'correct' : 'incorrect'}">
                            <i class="fas fa-${isCorrect ? 'check-circle' : 'times-circle'}"></i>
                            <span>${isCorrect ? 'Correct!' : 'Not quite...'}</span>
                        </div>
                        <p style="margin: 8px 0 0; color: var(--text-secondary);">
                            ${isCorrect ? message.correct : message.incorrect}
                        </p>
                    `;
                }
            }
        }
        
        function submitQuiz(quizNum) {
            const questions = document.querySelectorAll(`[data-quiz="${quizNum}"]`);
            let correct = 0;
            let total = 0;
            
            questions.forEach(q => {
                const qNum = q.getAttribute('data-q');
                if (qNum) {
                    total++;
                    const answer = quizAnswers[`${quizNum}-${qNum}`];
                    const correctAnswer = q.getAttribute('data-answer');
                    if (answer === correctAnswer) correct++;
                }
            });
            
            const scoreDiv = document.getElementById(`quiz-score-${quizNum}`);
            if (scoreDiv) {
                scoreDiv.style.display = 'block';
                const percentage = Math.round((correct / total) * 100);
                const emoji = percentage >= 80 ? '🎉' : percentage >= 60 ? '👍' : '📚';
                scoreDiv.innerHTML = `Score: ${correct}/${total} (${percentage}%) ${emoji}`;
            }
        }

        // Exercise completion tracking
        let completedExercises = new Set();
        
        function markComplete(exerciseNum) {
            completedExercises.add(exerciseNum);
            updateProgress();
            
            // Visual feedback
            const exercise = document.querySelector(`[data-exercise="${exerciseNum}"]`);
            if (exercise) {
                exercise.style.borderColor = 'var(--accent)';
                const number = exercise.querySelector('.exercise-number');
                if (number) {
                    number.style.background = 'linear-gradient(135deg, var(--accent), var(--accent-light))';
                    number.innerHTML = '<i class="fas fa-check"></i>';
                }
            }
        }
        
        function updateProgress() {
            const total = 10;
            const completed = completedExercises.size;
            const percentage = (completed / total) * 100;
            
            document.getElementById('progressText').textContent = `${completed}/${total}`;
            document.getElementById('progressFill').style.width = `${percentage}%`;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 RAG Tutorial loaded successfully!');
            Prism.highlightAll();
        });
    </script>

</body>
</html>